<!DOCTYPE html>
<html>
<head>
<title>网站评测</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css"
    href="./css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="./css/index.css">
<script type="text/javascript" src="./js/lib/jquery-1.11.3.js"></script>
</head>
<body>
    Start_Date:
    <input type="date" id="date1" name="user_date" /> End_Date:
    <input type="date" id="date2" name="user_date" />
    <button type="button">提交</button>
    <div id="main" name="news"></div>
    <script type="text/javascript"
        src="./js/lib/echarts.js"></script>
    <script type="text/javascript"
        src="./js/lib/esl.js"></script>
    <script type="text/javascript">
        var jsonobj, status, message;
        $("button")
                .click(
                        function() {
                            $.ajax({
                                url : "./testword.json",
                                type : "POST",
                                contentType : "json",
                                dataType : "json",
                                success : function(data) {
                                    alert('success');
                                    status = data.status;
                                    message = data.message;
                                    jsonobj = data.results;
                                    console.log(jsonobj);
                                    //var option.series=jsonobj.series;

                                },
                                error : function() {
                                    alert('没有进入');
                                }
                            });

                            require.config({
                                paths : {
                                    echarts : './lib/echarts-2.2.7/build/dist'
                                }
                            });
                            require(
                                    //少一个
                                    [ 'echarts', 'echarts/chart/force' // 使用柱状图就加载bar模块，按需加载
                                    ],

                                    function(ec) {//少一个
                                        // 基于准备好的dom，初始化echarts图表
                                        var myChart = ec.init(document
                                                .getElementById('main'));

                                        var option = {//少一个
                                            title : {
                                                text : '热词统计',
                                                x : 'right',
                                                y : 'bottom'
                                            },
                                            tooltip : {
                                                trigger : 'item',
                                                formatter : '{a} : {b}'
                                            },
                                            toolbox : {
                                                show : true,
                                                feature : {
                                                    restore : {
                                                        show : true
                                                    },
                                                    magicType : {
                                                        show : true,
                                                        type : [ 'force',
                                                                'chord' ]
                                                    },
                                                    saveAsImage : {
                                                        show : true
                                                    }
                                                }
                                            },
                                            legend : {
                                                x : 'left',
                                                data : [ '褒', '贬', '中' ]
                                            },
                                            series : [ {
                                                type : 'force',
                                                name : "热词统计",
                                                ribbonType : false,
                                                categories : [ {
                                                    name : '褒'
                                                }, {
                                                    name : '贬'
                                                }, {
                                                    name : '中'
                                                } ],
                                                itemStyle : {
                                                    normal : {
                                                        label : {
                                                            show : true,
                                                            textStyle : {
                                                                color : '#333'
                                                            }
                                                        },
                                                        nodeStyle : {
                                                            brushType : 'both',
                                                            borderColor : 'rgba(255,215,0,0.4)',
                                                            borderWidth : 1
                                                        },
                                                        linkStyle : {
                                                            type : 'curve'
                                                        }
                                                    },
                                                    emphasis : {
                                                        label : {
                                                            show : false
                                                        // textStyle: null      // 默认使用全局文本样式，详见TEXTSTYLE
                                                        },
                                                        nodeStyle : {
                                                        //r: 30
                                                        },
                                                        linkStyle : {}
                                                    }
                                                },
                                                useWorker : false,
                                                minRadius : 15,
                                                maxRadius : 25,
                                                gravity : 1.1,
                                                scaling : 1.1,
                                                roam : 'move',

                                                nodes : (function() {
                                                    var length1 = jsonobj.nodes.length;
                                                    //var now = new Date();
                                                    function fun(category,name,value) {
                                                        this.category = category;
                                                        this.name = name;
                                                        this.value = value;
                                                    
                                                    }
                                                    //var res = new Object();
                                                    var res=[];
                                                    for (var i = 0; i < length1; i++) {
                                                        //console.log(jsonobj.nodes[i].category);
                                                        res[i]=new fun(jsonobj.nodes[i].category,jsonobj.nodes[i].name,jsonobj.nodes[i].value);
                                                        
                                                    }
                                                    return res;
                                                })(),
                                                links : (function() {
                                                    var length1 = jsonobj.links.length;
                                                    function fun(source,target,weight) {
                                                        this.source = source;
                                                        this.target = target;
                                                        this.weight = weight;
                                                    
                                                    }
                                                    //var res = new Object();
                                                    var res=[];
                                                    for (var i = 0; i < length1; i++) {
                                                        res[i]=new fun(jsonobj.links[i].source,jsonobj.links[i].target,jsonobj.links[i].weight);
                                                        //console.log(res[i]);
                                                    }
                                                    return res;
                                                })()
                                            } ]
                                        };
                                        // 为echarts对象加载数据 
                                        myChart.setOption(option);

                                    });
                        });
    </script>
</body>
</html>